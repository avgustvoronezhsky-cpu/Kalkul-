import os
from telegram import Update
from telegram.ext import Updater, CommandHandler, CallbackContext
from promo_texts import PROMO_MESSAGE

# ТВОИ ДАННЫЕ
BOT_TOKEN = os.getenv("BOT_TOKEN")  # Вставишь в Render или Railway
ADMIN_ID = 881133631  # твой Telegram ID

def start(update: Update, context: CallbackContext):
    update.message.reply_text("Привет! Я бот для рассылки информации о помощи при ДТП.")

def mypromo(update: Update, context: CallbackContext):
    if update.effective_user.id == ADMIN_ID:
        update.message.reply_text(PROMO_MESSAGE)
    else:
        update.message.reply_text("У вас нет доступа.")

def sendpromo(update: Update, context: CallbackContext):
    if update.effective_user.id != ADMIN_ID:
        update.message.reply_text("У вас нет доступа.")
        return

    if not context.args:
        update.message.reply_text("Использование: /sendpromo <chat_id>")
        return

    try:
        chat_id = int(context.args[0])
        context.bot.send_message(chat_id=chat_id, text=PROMO_MESSAGE)
        update.message.reply_text(f"Сообщение отправлено в {chat_id}")
    except Exception as e:
        update.message.reply_text(f"Ошибка: {e}")

def main():
    updater = Updater(BOT_TOKEN, use_context=True)
    dp = updater.dispatcher

    dp.add_handler(CommandHandler("start", start))
    dp.add_handler(CommandHandler("mypromo", mypromo))
    dp.add_handler(CommandHandler("sendpromo", sendpromo))

    updater.start_polling()
    updater.idle()

if __name__ == "__main__":
    main()
